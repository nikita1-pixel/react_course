<!DOCTYPE html>
<html>
<head>
  <title>ChatBot</title>
</head>
<body>
  <div class="js-container"></div>

  <script src="https://unpkg.com/supersimpledev/react.js"></script>
  <script src="https://unpkg.com/supersimpledev/react-dom.js"></script>

  <script src="https://unpkg.com/supersimpledev/chatbot.js"></script>

  <script src="https://unpkg.com/supersimpledev/babel.js"></script>
  <script type="text/babel">

  function ChatInput({ chatMessages, setChatMessages }){
    const[inputText, setInputText] = React.useState('');

    function saveInputText(event){
      setInputText(event.target.value);
    }

    function sendMessage(){
      const newChatMeassages = [
        ...chatMessages,
        {
          message: inputText,
          sender: 'user',
          id: crypto.randomUUID()
        }
      ]
      
      setChatMessages(newChatMeassages);

       const response = Chatbot.getResponse(inputText);
         setChatMessages([
        ...newChatMeassages,
        {
          message: response,
          sender: 'robot',
          id: crypto.randomUUID()
        }
      ]);

      setInputText('');
    }
  return (
  <>
    <input 
      placeholder="Send a message to your ChatBot"
      size ="30" 
      onChange={saveInputText}
      value={inputText}
    />
    <button 
      onClick={sendMessage}>
        Send
      </button>
    </>
    )}
    function ChatMessage({message, sender}){
    // const message =  props.message;
    // const sender = props.sender;
    //destructuring the props object
    // const {message, sender} = props;
                
    // if(sender === "robot"){
    //     return(
    //         <div>
    //             <img src="robot.png" width="50px"/>
    //             {message}
    //         </div>
    //     )

   // }
    return(
      <div>
      {sender === "robot" && (
        <img src="robot.png" width="50px"/>
      )}
      {message}
      { sender ==="user" && (
      <img src="user.png" width="50px"/>
      )}
      </div>
     )
  }

    function ChatMessages( {chatMessages}){
    return (
      <>
        {chatMessages.map((chatMeassge) => {
          return (
          <ChatMessage 
            message={chatMeassge.message} //props {object.message}
            sender={chatMeassge.sender}
            key={chatMeassge.id}
          />
          )
        })}
      </>
        )
    }

    function App (){
      const [chatMessages, setChatMessages] = React.useState([{
        message : 'Hello ChatBot',
        sender : 'user',
        id: 'id1'
        },{
        message : 'Hello! How can I help you today?',
        sender : 'robot',
        id: 'id2'
        },{
        message : 'Can you get me todays date?',
        sender : 'user',
        id: 'id3'
        },{
        message : "Sure! Today's date is June 5, 2024.",
        sender : 'robot',
        id: 'id4'
      }])
      // const [chatMessages, setChatMessages] = array; //array destructuring
      // const chatMessages = array[0];//the current data
      // const setChatMessages = array[1];//updater function

    return(
      <>
        <ChatInput 
         chatMessages={chatMessages}
         setChatMessages={setChatMessages}
        />
        <ChatMessages 
         chatMessages={chatMessages}
        />
      </>
      )
      }
        
      const container = document.querySelector('.js-container');
      ReactDOM.createRoot(container).render(<App />);
    </script>
  </body>
</html>